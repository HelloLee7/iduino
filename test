from zeroconf import ServiceBrowser, Zeroconf
import time

class MyListener:
    def __init__(self):
        self.ip_address = None

    def remove_service(self, zeroconf, type, name):
        pass

    def add_service(self, zeroconf, type, name):
        info = zeroconf.get_service_info(type, name)
        if info:
            self.ip_address = socket.inet_ntoa(info.addresses[0])

zeroconf = Zeroconf()
listener = MyListener()
browser = ServiceBrowser(zeroconf, "_http._tcp.local.", listener)

# IP 주소를 찾을 때까지 대기
while listener.ip_address is None:
    time.sleep(1)

print(f"Arduino IP address: {listener.ip_address}")

zeroconf.close()